/**
 * @fileoverview Detect the access of the innerHTML property.
 * @author Christopher Fenner (D065687)
 * @ESLint Version 0.8.0 / March 2016
 */

// ------------------------------------------------------------------------------
// Rule Disablement
// ------------------------------------------------------------------------------
// ------------------------------------------------------------------------------
// Invoking global form of strict mode syntax for whole script
// ------------------------------------------------------------------------------
/*eslint-disable strict*/
// ------------------------------------------------------------------------------
// Rule Definition
// ------------------------------------------------------------------------------
module.exports = {
    create: function(context) {
        "use strict";
        var MESSAGE = "Accessing the inner html is not recommended.";
        // --------------------------------------------------------------------------
        // Basic Helpers
        // --------------------------------------------------------------------------
        function isType(node, type) {
            return node && node.type === type;
        }

        function isLiteral(node) {
            return isType(node, "Literal");
        }

        function isIdentifier(node) {
            return isType(node, "Identifier");
        }

        // --------------------------------------------------------------------------
        // Helpers
        // --------------------------------------------------------------------------

        function isValid(property) {
            // anything is valid, except 'innerHTML'
            if (isIdentifier(property)) {
                return property.name !== "innerHTML";
            } else if (isLiteral(property)) {
                return property.value !== "innerHTML";
            }
            return true;
        }

        // --------------------------------------------------------------------------
        // Public
        // --------------------------------------------------------------------------
        return {
            "MemberExpression": function(node) {
                if (!isValid(node.property)) {
                    context.report(node, MESSAGE);
                }
            }
        };
    }
};
