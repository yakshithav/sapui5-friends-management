/**
 * @fileoverview Detect usage of document.styleSheets
 * @author Christopher Fenner
 */
"use strict";

//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

var rule = require("../../../lib/rules/sap-no-dynamic-style-insertion.js"),

    RuleTester = require("eslint").RuleTester;


//------------------------------------------------------------------------------
// Tests
//------------------------------------------------------------------------------

var ruleTester = new RuleTester();
var errorMessage = "Dynamic style insertion, use library CSS or lessifier instead";
ruleTester.run("sap-no-dynamic-style-insertion", rule,              
                {
                    valid: [
                            "myDocument.createElementSome(foo);",
                            "var abd = abc[i];", "foo.back();",
                            "window.eventfoo.returnValue = false;",
                            "var oLink = document.createElement('a');"
                    ],
                    invalid: [
                            {
                                code: "var sheet = document.styleSheets[i];",
                                errors: [
                                    {
                                        message: errorMessage,
                                        type: "MemberExpression"
                                    }
                                ]
                            },
                            {
                                code: "var w= window, x = w.document, mydocument = w.document;var sheet = mydocument['styleSheets'][i];",
                                errors: [
                                    {
                                        message: errorMessage,
                                        type: "MemberExpression"
                                    }
                                ]
                            },
                            {
                                code: "var mydocument = document;var sheet = mydocument.styleSheets[i];",
                                errors: [
                                    {
                                        message: errorMessage,
                                        type: "MemberExpression"
                                    }
                                ]
                            },
                            {
                                code: "var abc = document.styleSheets.length;",
                                errors: [
                                    {
                                        message: errorMessage,
                                        type: "MemberExpression"
                                    }
                                ]
                            },
                            {
                                code: "var abcdocumnt = window.document; var sheet = abcdocumnt.styleSheets.length;",
                                errors: [
                                    {
                                        message: errorMessage,
                                        type: "MemberExpression"
                                    }
                                ]
                            }
                    ]
                });
