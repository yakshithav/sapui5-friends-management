/**
 * @fileoverview Detect some warning for usages of (window.)document APIs
 * @author Achref Kilani Jrad
 * @ESLint Version 0.14.0 / February 2015
 */

// ------------------------------------------------------------------------------
// Invoking global form of strict mode syntax for whole script
// ------------------------------------------------------------------------------
"use strict";

//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

var rule = require("../../../lib/rules/sap-timeout-usage.js"),

    RuleTester = require("eslint").RuleTester;


//------------------------------------------------------------------------------
// Tests
//------------------------------------------------------------------------------

var errorMessage = "Timeout with value > 0";
var ruleTester = new RuleTester();
ruleTester.run("sap-timeout-usage", rule, 
                {
                    valid: [
                            "oViewModel = new JSONModel({ shareSendEmailMessage: this.getResourceBundle().getText('shareSendEmailWorklistMessage', [window.location.href])});",
                            "setTimeout(function(){ alert('noError'); }, 0);",
                            "setTimeout(function(){ alert('noError'); });",
                            "window.setTimeout(myHandler);"
                    ],
                    invalid: [
                            {
                                code: "setTimeout(function(){ that.oReportTileOptionsCarousel.rerender(); }, '500');",
                                errors: [
                                    {
                                        message: errorMessage,
                                        type: "CallExpression"
                                    }
                                ]
                            },
                            {
                                code: "setTimeout(function(){ that.oReportTileOptionsCarousel.rerender(); }, 100);",
                                errors: [
                                    {
                                        message: errorMessage,
                                        type: "CallExpression"
                                    }
                                ]
                            },
                            {
                                code: "window.setTimeout(function(){ that.oReportTileOptionsCarousel.rerender(); }, '500');",
                                errors: [
                                    {
                                        message: errorMessage,
                                        type: "CallExpression"
                                    }
                                ]
                            },
                            {
                                code: "var test0 = window, test1 = window; test1.setTimeout(myHandler, '500');",
                                errors: [
                                    {
                                        message: errorMessage,
                                        type: "CallExpression"
                                    }
                                ]
                            },
                            {
                                code: "test2 = window; test2.setTimeout(myHandler, '500');",
                                errors: [
                                    {
                                        message: errorMessage,
                                        type: "CallExpression"
                                    }
                                ]
                            }
                    ]
                });
