/**
 * @fileoverview Detect some forbidden usages of (window.)document APIs
 * @author Achref Kilani Jrad
 */
"use strict";

//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

var rule = require("../../../lib/rules/sap-no-location-reload.js"),

    RuleTester = require("eslint").RuleTester;


//------------------------------------------------------------------------------
// Tests
//------------------------------------------------------------------------------

var ruleTester = new RuleTester();
var errorMessage = "location.reload() is not permitted.";
ruleTester.run("sap-no-location-reload", rule, 
 {
    valid: [
        "var x = myLocation; x.reload();"
    ],
    invalid: [
            {
                code: "location.reload();",
                errors: [
                    {
                        message: errorMessage,
                        type: "CallExpression"
                    }
                ]
            }, {
                code: "var mylocation = location;mylocation.reload();",
                errors: [
                    {
                        message: errorMessage,
                        type: "CallExpression"
                    }
                ]
            }, {
                code: "var f = window, w = window; w.location.reload();",
                errors: [
                    {
                        message: errorMessage,
                        type: "CallExpression"
                    }
                ]
            }, {
                code: "var mylocation = window.location;mylocation.reload();",
                errors: [
                    {
                        message: errorMessage,
                        type: "CallExpression"
                    }
                ]
            }
    ]
});
