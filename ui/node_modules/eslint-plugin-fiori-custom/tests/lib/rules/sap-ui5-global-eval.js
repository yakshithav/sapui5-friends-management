
// ------------------------------------------------------------------------------
// Invoking global form of strict mode syntax for whole script
// ------------------------------------------------------------------------------
"use strict";


//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

var rule = require("../../../lib/rules/sap-ui5-global-eval.js"),

    RuleTester = require("eslint").RuleTester;


//------------------------------------------------------------------------------
// Tests
//------------------------------------------------------------------------------

var ruleTester = new RuleTester();
ruleTester
        .run("sap-ui5-global-eval", rule, {
                    valid: [
                       
                        {
                            code: 
                               //There is no valid scenario for globalEval
                                ``,
                        }
                            
                    ],
                    invalid: [
                        {
                            code: 
                                `jQuery.globalEval( "var newVar = true;" );`,
                            errors: [
                                {
                                    message: "Usage of globalEval() / eval() is not allowed due to strict Content Security Policy.",
                                    type: "CallExpression"
                                }
                            ]
                        },
                        {
                            code: 
                                `jQuery.sap.globalEval( "var newVar = true;" );`,
                            errors: [
                                {
                                    message: "Usage of globalEval() / eval() is not allowed due to strict Content Security Policy.",
                                    type: "CallExpression"
                                }
                            ]
                        },
                        {
                            code: 
                                `$.globalEval( "var newVar = true;" );`,
                            errors: [
                                {
                                    message: "Usage of globalEval() / eval() is not allowed due to strict Content Security Policy.",
                                    type: "CallExpression"
                                }
                            ]
                        },
                        {
                            code: 
                                `$.sap.globalEval( "var newVar = true;" );`,
                            errors: [
                                {
                                    message: "Usage of globalEval() / eval() is not allowed due to strict Content Security Policy.",
                                    type: "CallExpression"
                                }
                            ]
                        },
                        {
                            code: 
                                `var a = jQuery.sap;
                                 a.globalEval( "var newVar = true;" );`,
                            errors: [
                                {
                                    message: "Usage of globalEval() / eval() is not allowed due to strict Content Security Policy.",
                                    type: "CallExpression"
                                }
                            ]
                        }
                    ]
                });