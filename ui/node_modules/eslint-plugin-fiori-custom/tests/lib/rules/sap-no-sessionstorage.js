/**
 * @fileoverview Detect usage of session storage
 * @author Achref Kilani Jrad
 * @ESLint			Version 0.14.0 / February 2015
 */

// ------------------------------------------------------------------------------
// Invoking global form of strict mode syntax for whole script
// ------------------------------------------------------------------------------

"use strict";

//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

var rule = require("../../../lib/rules/sap-no-sessionstorage.js"),

    RuleTester = require("eslint").RuleTester;


//------------------------------------------------------------------------------
// Tests
//------------------------------------------------------------------------------

var ruleTester = new RuleTester();
var errorMessage = "For security reasons, the usage of session storage is not allowed in a Fiori application";
ruleTester.run("sap-no-sessionstorage", rule, 
				{

					valid: [

					"sessionStorageSome.setObj(this.SETTINGS_NAME, this.objSettings);" ],

					invalid: [
							{
								code: "sessionStorage.setObj(this.SETTINGS_NAME, this.objSettings);",
								errors: [ {
									message: errorMessage,
									type: "MemberExpression"
								} ]
							},
							{
								code: "var abc = sessionStorage;abc.setObj(this.SETTINGS_NAME, this.objSettings);",
								errors: [ {
									message: errorMessage,
									type: "MemberExpression"
								} ]
							},
							{
								code: "var abc = window.sessionStorage;abc.setObj(this.SETTINGS_NAME, this.objSettings);",
								errors: [ {
									message: errorMessage,
									type: "MemberExpression"
								} ]
							} ]
				});
