"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getPrompts = getPrompts;
const i18n_1 = require("../../i18n");
const project_access_1 = require("@sap-ux/project-access");
const project_input_validator_1 = require("@sap-ux/project-input-validator");
/**
 * Validates the OData Source URI prompt.
 *
 * @param value The value to validate.
 * @returns {boolean | string} True if the value is a valid URI, or an error message if not a valid URI or empty.
 */
function validatePromptOdataURI(value) {
    const validationResult = (0, project_input_validator_1.validateEmptyString)(value);
    if (typeof validationResult === 'string') {
        return validationResult;
    }
    if (!(0, project_input_validator_1.isDataSourceURI)(value)) {
        return (0, i18n_1.t)('validators.errorInvalidDataSourceURI');
    }
    return true;
}
/**
 * Validates the Annotation URI prompt.
 *
 * @param value The value to validate.
 * @returns {boolean | string} True if the value is a valid URI or empty, or an error message if not a valid URI.
 */
function validatePromptAnnotationURI(value) {
    const validationResult = (0, project_input_validator_1.validateEmptyString)(value);
    if (typeof validationResult === 'string') {
        return true;
    }
    if (!(0, project_input_validator_1.isDataSourceURI)(value)) {
        return (0, i18n_1.t)('validators.errorInvalidDataSourceURI');
    }
    return true;
}
/**
 * Gets the prompts for changing the data source.
 *
 * @param {Record<string, ManifestNamespace.DataSource>} dataSources - Data sources from the manifest.
 * @returns {YUIQuestion<ChangeDataSourceAnswers>[]} The questions/prompts.
 */
function getPrompts(dataSources) {
    const dataSourceIds = Object.keys((0, project_access_1.filterDataSourcesByType)(dataSources, 'OData'));
    return [
        {
            type: 'list',
            name: 'id',
            message: (0, i18n_1.t)('prompts.oDataSourceLabel'),
            choices: dataSourceIds,
            default: dataSourceIds[0],
            store: false,
            guiOptions: {
                mandatory: true,
                hint: (0, i18n_1.t)('prompts.oDataSourceTooltip')
            }
        },
        {
            type: 'input',
            name: 'uri',
            message: (0, i18n_1.t)('prompts.oDataSourceURILabel'),
            guiOptions: {
                mandatory: true,
                hint: (0, i18n_1.t)('prompts.oDataSourceURITooltip')
            },
            validate: validatePromptOdataURI,
            when: !!dataSourceIds.length,
            store: false
        },
        {
            type: 'number',
            name: 'maxAge',
            message: (0, i18n_1.t)('prompts.maxAgeLabel'),
            guiOptions: {
                hint: (0, i18n_1.t)('prompts.maxAgeTooltip')
            },
            when: (answers) => answers.uri !== ''
        },
        {
            type: 'input',
            name: 'annotationUri',
            message: (0, i18n_1.t)('prompts.oDataAnnotationSourceURILabel'),
            guiOptions: {
                hint: (0, i18n_1.t)('prompts.oDataAnnotationSourceURITooltip')
            },
            validate: validatePromptAnnotationURI
        }
    ];
}
//# sourceMappingURL=index.js.map